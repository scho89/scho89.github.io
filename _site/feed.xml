<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.2.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2022-08-02T02:18:50+00:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">scho blog</title><subtitle>scho&apos;s workshop</subtitle><author><name>조상호 / Sangho Cho</name></author><entry><title type="html">Defender for Cloud Apps file API “Insufficient role based permissions” issue</title><link href="http://localhost:4000/ko-kr/microsoft365/Defender-for-Cloud-Apps-API-file-permission-error/" rel="alternate" type="text/html" title="Defender for Cloud Apps file API “Insufficient role based permissions” issue" /><published>2022-07-12T00:00:00+00:00</published><updated>2022-07-12T00:00:00+00:00</updated><id>http://localhost:4000/ko-kr/microsoft365/Defender-for-Cloud-Apps-API-file-permission-error</id><content type="html" xml:base="http://localhost:4000/ko-kr/microsoft365/Defender-for-Cloud-Apps-API-file-permission-error/"><![CDATA[<h2 id="서론">서론</h2>
<p>Microsoft Defender for Cloud Apps alert 및 세부내용 분석을 위한 스크립트를 작성하면서 특정 조건에서 <a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-files">file API</a>가 작동하지 않는것을 확인했습니다.<br />
이곳 저곳 돌아다니며 찾아봤지만 관련 정보를 찾을 수 없었습니다. 혹시 다른이들에게 도움이 될까 하여 글로 남겨둡니다.</p>

<h2 id="증상">증상</h2>
<p><a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-authentication-application">application context</a>를 통해 인증한 뒤 file API를 호출하면 권한 오류가 발생합니다.<br />
증상은 list file, fetch file 모두 발생합니다.</p>

<p><img src="http://localhost:4000/assets/images/posts/2022-07-12-Defender-for-Cloud-Apps-API-file-permission-error-symptom.png" alt="symptom" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Invoke-RestMethod : {"detail": "Insufficient role based permissions", "correlation_id": "d0a34b91-baa1-4c3d-809d-db8ca7c10460"}
위치 줄:1 문자:8
+ $res = Invoke-RestMethod -Uri "https://kor2.us3.portal.cloudappsecuri ...
+        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: (System.Net.HttpWebRequest:HttpWebRequest) [Invoke-RestMethod], WebException
    + FullyQualifiedErrorId : WebCmdletWebResponseException,Microsoft.PowerShell.Commands.InvokeRestMethodCommand
</code></pre></div></div>

<h2 id="해결-방법">해결 방법</h2>
<p>Microsoft를 통해 확인 시 <a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-authentication-application">application context</a> 통해서 인증하는 경우 file API를 사용할 수 없습니다. (2022/7/7 기준)</p>

<p>File API를 이용하기 위해서는 MDCA 포털에서 <a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-tokens-legacy">레거시 방식</a>의 API 키를 생성해서 사용해야합니다. (보안 확장 -&gt; API 키)<br />
(문서의 예제에서는 이 방법으로 설명하고 있습니다.)</p>

<p>문서의 그림이 오래되어 하나 첨부합니다.<br />
<img src="http://localhost:4000/assets/images/posts/2022-07-12-Defender-for-Cloud-Apps-API-file-permission-error-securityextension.png" alt="securityextension" /></p>

<p><img src="http://localhost:4000/assets/images/posts/2022-07-12-Defender-for-Cloud-Apps-API-file-permission-error-apiToken.png" alt="apiToken" /></p>

<p><a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-introduction#api-tokens">API token</a>을 사용하는 경우, Microsoft에서 권장하는 방식인 <a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-authentication-application">application context</a>과는 좀 다른 형태로 요청 헤더를 만들어야합니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$apiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"your api key"</span><span class="w">
</span><span class="nv">$authToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s2">"Authorization"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Token "</span><span class="err">+</span><span class="w"> </span><span class="nv">$apikey</span><span class="p">}</span><span class="w">
</span><span class="nv">$res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://kor2.us3.portal.cloudappsecurity.com/api/v1/files/"</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$authToken</span><span class="w"> 
</span></code></pre></div></div>

<p>API 토큰을 이용하는 경우 아래와 같이 정상작동합니다.</p>

<p><img src="http://localhost:4000/assets/images/posts/2022-07-12-Defender-for-Cloud-Apps-API-file-permission-error-legacy.png" alt="apiToken" /></p>

<h2 id="증상-재현-방법">증상 재현 방법</h2>
<p><a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-authentication-application">application context</a>를 이용해 file API를 호출하는 샘플 코드는 다음과 같습니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Basic information</span><span class="w">
</span><span class="nv">$ClientId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"72898937-bfcf-412e-a554-a4e438d6095c"</span><span class="w">
</span><span class="nv">$ClientSecret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'*'</span><span class="w">
</span><span class="nv">$TenantId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'023ef17e-4a76-4230-a8f2-e0b9e89627bf'</span><span class="w">
</span><span class="nv">$resourceAppIdUri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'05a65629-4c1b-48c1-a78b-804c4abdd4af'</span><span class="w">
</span><span class="nv">$oAuthUri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://login.microsoftonline.com/</span><span class="nv">$TenantId</span><span class="s2">/oauth2/token"</span><span class="w">

</span><span class="nv">$authBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">Ordered</span><span class="p">]</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="nx">resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="nv">$resourceAppIdUri</span><span class="s2">"</span><span class="w">
    </span><span class="nx">client_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="nv">$ClientId</span><span class="s2">"</span><span class="w">
    </span><span class="nx">client_secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"</span><span class="nv">$ClientSecret</span><span class="s2">"</span><span class="w">
    </span><span class="nx">grant_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'client_credentials'</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="nv">$authResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Post</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$oAuthUri</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="nv">$authBody</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">Stop</span><span class="w">
</span><span class="nv">$token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$authResponse</span><span class="o">.</span><span class="nf">access_token</span><span class="w">
</span><span class="nv">$authToken</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="s1">'Authorization'</span><span class="o">=</span><span class="s1">'Bearer '</span><span class="err">+</span><span class="nv">$token</span><span class="p">}</span><span class="w">

</span><span class="nv">$res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://kor2.us3.portal.cloudappsecurity.com/api/v1/files/"</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$authToken</span><span class="w"> 
</span></code></pre></div></div>

<p>이떄 API 호출에 필요한 권한(investigation.read)는 어플리케이션에 할당되어 있습니다. 다른 모든 권한을 할당하더라도 증상은 해결되지 않습니다.</p>

<p><img src="http://localhost:4000/assets/images/posts/2022-07-12-Defender-for-Cloud-Apps-API-file-permission-error-apipermission.png" alt="apipermission" /></p>

<h2 id="기타-의견">기타 의견</h2>
<p>Activity API에서 제공하는 pagination을 alert이나 file에서는 제공하지 않는 것 같습니다.<br />
<code class="language-plaintext highlighter-rouge">hasNext</code>가 <code class="language-plaintext highlighter-rouge">true</code>이지만 <code class="language-plaintext highlighter-rouge">isScan: true</code>를 body에 넣어 POST를 보내도 다음 페이지의 쿼리 주소는 제공되지 않습니다. Alert이나 file문서에 따로 언급이 없는 것을 보니, Activity 에서만 기능을 제공하는것 같습니다.</p>

<p><a href="https://docs.microsoft.com/en-us/defender-cloud-apps/api-activities-investigate-script#request-body-parameters">Activities requset body parameters</a></p>]]></content><author><name>조상호 / Sangho Cho</name></author><category term="ko-kr" /><category term="Microsoft365" /><category term="Defender for Cloud Apps" /><summary type="html"><![CDATA[서론 Microsoft Defender for Cloud Apps alert 및 세부내용 분석을 위한 스크립트를 작성하면서 특정 조건에서 file API가 작동하지 않는것을 확인했습니다. 이곳 저곳 돌아다니며 찾아봤지만 관련 정보를 찾을 수 없었습니다. 혹시 다른이들에게 도움이 될까 하여 글로 남겨둡니다.]]></summary></entry><entry><title type="html">Apps for Microsoft 365 update script</title><link href="http://localhost:4000/en-us/microsoft365/Update-script/" rel="alternate" type="text/html" title="Apps for Microsoft 365 update script" /><published>2022-07-11T00:00:00+00:00</published><updated>2022-07-11T00:00:00+00:00</updated><id>http://localhost:4000/en-us/microsoft365/Update-script</id><content type="html" xml:base="http://localhost:4000/en-us/microsoft365/Update-script/"><![CDATA[<h2 id="background">Background</h2>
<p>It starts from idea of <a href="https://blog.limcm.kr/">colleague</a>.</p>

<p>업무 특성 상 Office 클라이언트의 업데이트 채널이나 빌드를 변경할 일이 잦았는데, 이를 좀 더 편하게 하고자 만들었었다.<br />
무엇이든지 지나고 나서 보면, 이전 작업에 부족한게 많이 보이기 마련이지요.<br />
민망함을 무릅쓰고 이야기를 적어봅니다. 스크립트를 제작했을 당시 버전의 제 머리(?)를 이용합니다.</p>

<p>임직원의 PC를 관리할 수 있는 인프라가 갖춰진 경우, Office 클라이언트의 버전을 관리할 수 있는 방법은 <a href="https://docs.microsoft.com/en-us/deployoffice/change-update-channels">다양합니다</a>.<br />
하지만, 그런 인프라를 갖추지 못한 환경에서는 특정 버전에서 발생하는 문제가 생긴 경우 이를 대처하는게 여간 까다로운 일이 아닙니다.<br />
그런 환경에서 이를 통해 좀 더 편하게 문제에 대처할 수 있었으면 하는 마음을 담기도 했었습니다.</p>

<p>시간이 되면, 처음 만들 당시 보다는 좀 더 업그레이드된 버전의 머리(?)를 이용해 정리할 예정입니다.</p>

<h2 id="수동으로-업데이트-채널-빌드-변경">수동으로 업데이트 채널, 빌드 변경</h2>
<p>Office 클라이언트의 채널, 빌드를 원하는 값으로 지정하려면 아래의 과정을 진행해야 합니다.</p>

<h3 id="office-클라이언트-업데이트-채널-변경">Office 클라이언트 업데이트 채널 변경</h3>
<p>아래 둘 중 하나의 방법을 이용할 수 있습니다.</p>
<ul>
  <li>OfficeC2RClient.exe를 이용 <a href="https://docs.microsoft.com/en-us/deployoffice/update-channels-changes#office-deployment-tool">채널명</a>
    <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe"</span><span class="w"> </span><span class="n">/changesetting</span><span class="w"> </span><span class="nx">Channel</span><span class="o">=</span><span class="n">ChannelName</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li>레지스트리 수정
    <ul>
      <li>
        <p>다음 키를 원하는 채널에 맞게 변경해야합니다.<br />
<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration\CDNBaseUrl</code>
<img src="http://localhost:4000/assets/images/posts/2022-07-10-Offfice365-Update-script-registry.png" alt="registry" /></p>

        <table>
          <thead>
            <tr>
              <th>채널 명</th>
              <th>이전</th>
              <th>주소</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Beta Channel</td>
              <td>Insider Fast</td>
              <td>http://officecdn.microsoft.com/pr/5440fd1f-7ecb-4221-8110-145efaa6372f</td>
            </tr>
            <tr>
              <td>Current Channel (Preview)</td>
              <td>Insider Slow</td>
              <td>http://officecdn.microsoft.com/pr/64256afe-f5d9-4f86-8936-8840a6a4f5be</td>
            </tr>
            <tr>
              <td>Currnet Channel</td>
              <td>Monthly Channel</td>
              <td>http://officecdn.microsoft.com/pr/492350f6-3a01-4f97-b9c0-c7c6ddf67d60</td>
            </tr>
            <tr>
              <td>Montly Enterprise Channel</td>
              <td> </td>
              <td>http://officecdn.microsoft.com/pr/55336b82-a18d-4dd6-b5f6-9e5095c314a6</td>
            </tr>
            <tr>
              <td>Semi-Annual Enterprise Channel (Preview)</td>
              <td>Semi-Annual Channel (Targeted)</td>
              <td>http://officecdn.microsoft.com/pr/b8f9b850-328d-4355-9145-c59439a0c4cf</td>
            </tr>
            <tr>
              <td>Semi-Annual Enterprise Channel</td>
              <td>Semi-Annual Channel</td>
              <td>http://officecdn.microsoft.com/pr/7ffbc6bf-bc32-4f92-8982-f9dd17fd3114</td>
            </tr>
            <tr>
              <td>DevMain Channel (Dogfood)</td>
              <td> </td>
              <td>http://officecdn.microsoft.com/pr/ea4a4090-de26-49d7-93c1-91bff9e53fc3</td>
            </tr>
          </tbody>
        </table>
      </li>
      <li>
        <p>아래 키 삭제
<code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Updates\UpdateToVersion</code></p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="특정-빌드로-업데이트-다운그레이드-진행">특정 빌드로 업데이트 (다운그레이드) 진행</h3>
<p>각 채널에 맞는 <a href="https://docs.microsoft.com/en-us/officeupdates/update-history-microsoft365-apps-by-date">빌드 번호</a>를 참고하여 업데이트 (다운그레이드)를 진행합니다.<br />
빌드 번호가 맞지 않으면 <code class="language-plaintext highlighter-rouge">OfficeC2RClient.exe</code>를 실행해도 아무 반응이 없습니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"C:\Program Files\Common Files\Microsoft Shared\ClickToRun\OfficeC2RClient.exe"</span><span class="w"> </span><span class="n">/update</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">updatetoversion</span><span class="o">=</span><span class="mf">16.0</span><span class="o">.</span><span class="nf">0000</span><span class="o">.</span><span class="nf">0000</span><span class="w">
</span></code></pre></div></div>

<h2 id="클라이언트-업데이트-스크립트">클라이언트 업데이트 스크립트</h2>
<p>하지만 이런 작업도 한두번이지요. 여러번 작업할때, 또는 장치가 여러대이면 이만저만 번거로운게 아닙니다.<br />
그래서 아래와 같은 순서로 작동하는 스크립트를 작성합니다.</p>

<p>1) 각 채널별 <code class="language-plaintext highlighter-rouge">CDNBaseUrl</code> 확인<br />
  2) 각 채널에 맞는 빌드 번호를 확인<br />
  3) 현재 설정된 <code class="language-plaintext highlighter-rouge">CDNBaseUrl</code>과 원하는 <code class="language-plaintext highlighter-rouge">CDNBaseUrl</code> 비교하여 값 변경 / <code class="language-plaintext highlighter-rouge">Updatetoversion</code> 키 삭제<br />
  4) 업데이트 진행<br />
  5) 양식을 사용하여 GUI 형태로 구현<br />
  6) (필요한 경우) 자동 업데이트를 비활성화</p>

<h3 id="1-각-채널별-cdnbaseurl-확인">1) 각 채널별 CDNBaseUrl 확인</h3>
<p>직접… 테스트를 통해 값을 확인하였습니다.<br />
<a href="https://devblogs.microsoft.com/oldnewthing/20110802-00/?p=10003">DevMain Channel</a>을 제외한 모든 채널은 Docs문서를 참고하여 채널 변경 후 <code class="language-plaintext highlighter-rouge">CDNBaseUrl</code> 값을 확인할 수 있습니다.</p>

<h3 id="2-각-채널에-맞는-빌드-번호를-확인">2) 각 채널에 맞는 빌드 번호를 확인</h3>
<p>Microsoft Docs에서 각 채널별 빌드 번호를 확인할 수 있습니다.
스크립트에서는 Docs 문서의 HTML 본문에서 채널별 빌드를 정규식을 통해 분류했습니다.</p>

<p>문서 본문은 <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/invoke-webrequest?view=powershell-7.2"><code class="language-plaintext highlighter-rouge">Invoke-WebRequest</code></a>를 통해 가져올 수 있습니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://docs.microsoft.com/en-us/officeupdates/update-history-microsoft365-apps-by-date"</span><span class="w">
</span><span class="nv">$html</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$res</span><span class="o">.</span><span class="nf">content</span><span class="w">
</span></code></pre></div></div>

<p>가져온 HTML 문서에서 태그와 적절한 키워드를 이용하여 각 채널에 맞는 빌드 목록을 추려냅니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">regex</span><span class="p">]::</span><span class="n">matches</span><span class="p">(</span><span class="w"> </span><span class="nv">$html</span><span class="p">,</span><span class="w"> </span><span class="s1">'&lt;a href=\"(monthly-channel|current-channel)(.*?)&lt;/a&gt;'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>만약 원본 문서의 HTML 구조가 변경된다면, 정규식으로 필요한 데이터를 필터링 할 수 없어 빈 목록이 표시됩니다.</p>

<h3 id="3-현재-설정된-cdnbaseurl과-원하는-cdnbaseurl-비교하여-값-변경--updatetoversion-키-삭제">3) 현재 설정된 CDNBaseUrl과 원하는 CDNBaseUrl 비교하여 값 변경 / Updatetoversion 키 삭제</h3>
<p>레지스트리 키를 확인, 설정 및 삭제하는 cmdlet은 ItemProperty 명사를 이용합니다.</p>
<ul>
  <li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-itemproperty?view=powershell-7.2">Get-ItemProperty</a></li>
  <li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-itemproperty?view=powershell-7.2">Set-ItemProperty</a></li>
  <li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/remove-itemproperty?view=powershell-7.2">Remove-ItemProperty</a></li>
</ul>

<p>레지스트리 값 수정을 위해 <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/start-process?view=powershell-7.2"><code class="language-plaintext highlighter-rouge">Start-Process</code></a>를 이용해 필요한 부분만 상승된 권한(<code class="language-plaintext highlighter-rouge">-Verb RunAs</code>)으로  실행되게 하였습니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">if</span><span class="p">((</span><span class="n">Get-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration</span><span class="p">)</span><span class="o">.</span><span class="nf">CDNBaseUrl</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="nv">$CDNBaseUrlCurrent</span><span class="p">)</span><span class="w">        </span><span class="p">{</span><span class="w">
    </span><span class="nv">$ChannelChanged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
    </span><span class="n">Start-Process</span><span class="w"> </span><span class="nx">powershell.exe</span><span class="w"> </span><span class="nt">-Verb</span><span class="w"> </span><span class="nx">runAs</span><span class="p">{</span><span class="w">
    </span><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">CDNBaseUrl</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s2">"http://officecdn.microsoft.com/pr/492350f6-3a01-4f97-b9c0-c7c6ddf67d60"</span><span class="w">
    </span><span class="n">Remove-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Updates</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">UpdateToVersion</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="4-업데이트-진행">4) 업데이트 진행</h3>
<p>수동으로 진행할 때와 크게 다르지 않습니다. 
DevMain 채널인 경우 정확한 빌드를 확인할 수 없기 때문에 빌드를 입력하지 않습니다. (해당 채널 최신 버전으로 업데이트.)</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">if</span><span class="p">(</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="nv">$nameDevMain</span><span class="p">){</span><span class="w">
    </span><span class="nv">$build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"16.0."</span><span class="o">+</span><span class="p">((</span><span class="nv">$CmbBuild</span><span class="o">.</span><span class="nf">text</span><span class="w"> </span><span class="o">-split</span><span class="w"> </span><span class="s2">"Build "</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-split</span><span class="w"> </span><span class="s2">"\)"</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w">
    </span><span class="o">&amp;</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">CommonProgramFiles</span><span class="s2">\microsoft shared\ClickToRun\OfficeC2RClient.exe"</span><span class="w"> </span><span class="n">/update</span><span class="w"> </span><span class="nx">user</span><span class="w"> </span><span class="nx">updatetoversion</span><span class="o">=</span><span class="nv">$build</span><span class="p">}</span><span class="w">

</span><span class="kr">else</span><span class="p">{</span><span class="o">&amp;</span><span class="w"> </span><span class="s2">"</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">CommonProgramFiles</span><span class="s2">\microsoft shared\ClickToRun\OfficeC2RClient.exe"</span><span class="w"> </span><span class="n">/update</span><span class="w"> </span><span class="nx">user</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="5-양식을-사용하여-gui-형태로-구현">5) 양식을 사용하여 GUI 형태로 구현</h3>
<p>처음에는 단순히 텍스트로 최신 빌드 목록을 표시해주고 번호로 선택하는 형태로 구현했습니다.<br />
하지만 시간이 지날수록 빌드 목록을 길어지고, 화면에 표시하기 번거로워 채널과 빌드를 드롭 다운 목록 형태로 만들었습니다.<br />
  <img src="http://localhost:4000/assets/images/posts/2022-07-10-Offfice365-Update-script-drop-down-list.png" alt="drop-down-list" /></p>

<p>일부만 보면… 
기본 폼을 만들고, 드롭 다운 리스트(ComboBox), 버튼, 체크박스 등을 추가합니다.<br />
드롭 다운 리스틀 어떻게 채우는지, 이벤트 처리 (선택된 채널이 변경되는 경우, 그에 따른 빌드 목록 표시)를 어떻게 하는지 찾는데 시간을 좀 소요했던 기억이 납니다.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#Form </span><span class="w">

</span><span class="n">Add-Type</span><span class="w"> </span><span class="nt">-AssemblyName</span><span class="w"> </span><span class="nx">System.Windows.Forms</span><span class="w">

</span><span class="nv">$Form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">system.Windows.Forms.Form</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Office 365 Update Tool"</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">Size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Size</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span><span class="mi">120</span><span class="p">)</span><span class="w">
</span><span class="nv">$form</span><span class="o">.</span><span class="nf">MaximumSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Size</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span><span class="mi">150</span><span class="p">)</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">MinimumSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Size</span><span class="p">(</span><span class="mi">370</span><span class="p">,</span><span class="mi">150</span><span class="p">)</span><span class="w">
</span><span class="nv">$CenterScreen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.Windows.Forms.FormStartPosition</span><span class="p">]::</span><span class="n">CenterScreen</span><span class="p">;</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">StartPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$CenterScreen</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">TopMost</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$True</span><span class="w">

</span><span class="nv">$CmbChannel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Windows.Forms.ComboBox</span><span class="w">
</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Select release channel..."</span><span class="w">
</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="w">
</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Size</span><span class="p">(</span><span class="mi">330</span><span class="p">,</span><span class="mi">80</span><span class="p">)</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">controls</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$CmbChannel</span><span class="p">)</span><span class="w">

</span><span class="c"># 중략...</span><span class="w">

</span><span class="nv">$BtnUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Windows.Forms.Button</span><span class="w">
</span><span class="nv">$BtnUpdate</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Update"</span><span class="w">
</span><span class="nv">$BtnUpdate</span><span class="o">.</span><span class="nf">Location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Point</span><span class="p">(</span><span class="mi">265</span><span class="p">,</span><span class="mi">75</span><span class="p">)</span><span class="w">
</span><span class="nv">$BtnUpdate</span><span class="o">.</span><span class="nf">Enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$false</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">Controls</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$BtnUpdate</span><span class="p">)</span><span class="w">

</span><span class="nv">$ChkUpdate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Windows.Forms.Checkbox</span><span class="w">
</span><span class="nv">$ChkUpdate</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Disable updates"</span><span class="w">
</span><span class="nv">$ChkUpdate</span><span class="o">.</span><span class="nf">Location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Point</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">75</span><span class="p">)</span><span class="w">
</span><span class="nv">$ChkUpdate</span><span class="o">.</span><span class="nf">Size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-Object</span><span class="w"> </span><span class="nx">System.Drawing.Size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="w">
</span><span class="nv">$Form</span><span class="o">.</span><span class="nf">Controls</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$ChkUpdate</span><span class="p">)</span><span class="w">


</span><span class="c">#Cmb contents</span><span class="w">
</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Items</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$nameCurrent</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">
</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Items</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$nameMonthlyEnt</span><span class="p">)</span><span class="w"> </span><span class="err">&gt;&gt;</span><span class="w"> </span><span class="bp">$null</span><span class="w">

</span><span class="c"># 중략...</span><span class="w">

</span><span class="c">#Event handler</span><span class="w">

</span><span class="nv">$CmbChannel_SelectedIndexChanged</span><span class="w"> </span><span class="o">=</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nv">$BtnUpdate</span><span class="o">.</span><span class="nf">Enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$false</span><span class="w">
    </span><span class="kr">if</span><span class="p">(</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$nameCurrent</span><span class="p">){</span><span class="w">
        </span><span class="nv">$CmbBuild</span><span class="o">.</span><span class="nf">Items</span><span class="o">.</span><span class="nf">Clear</span><span class="p">()</span><span class="w">
        </span><span class="nv">$CmbBuild</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Select build number..."</span><span class="w">

        </span><span class="kr">for</span><span class="p">(</span><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="nv">$i</span><span class="w"> </span><span class="o">-lt</span><span class="w"> </span><span class="nv">$current</span><span class="o">.</span><span class="nf">count</span><span class="p">;</span><span class="nv">$i</span><span class="o">++</span><span class="p">){</span><span class="w">
            </span><span class="nv">$date_build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">([</span><span class="n">regex</span><span class="p">]::</span><span class="n">matches</span><span class="p">(</span><span class="nv">$current</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="nv">$i</span><span class="p">],</span><span class="s1">'Version \d{4} \(Build \d{4,5}\.\d{4,5}\)'</span><span class="w"> </span><span class="p">))</span><span class="o">.</span><span class="nf">value</span><span class="w">
            </span><span class="nv">$CmbBuild</span><span class="o">.</span><span class="nf">Items</span><span class="o">.</span><span class="nf">Add</span><span class="p">(</span><span class="nv">$date_build</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">

</span><span class="c"># 중략...</span><span class="w">

    </span><span class="kr">elseif</span><span class="p">(</span><span class="nv">$CmbChannel</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$nameDevMain</span><span class="p">){</span><span class="w">
        </span><span class="nv">$BtnUpdate</span><span class="o">.</span><span class="nf">Enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
        </span><span class="nv">$CmbBuild</span><span class="o">.</span><span class="nf">Items</span><span class="o">.</span><span class="nf">Clear</span><span class="p">()</span><span class="w">
        </span><span class="nv">$CmbBuild</span><span class="o">.</span><span class="nf">Text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Update to the latest build."</span><span class="w">       
    </span><span class="p">}</span><span class="w">

</span><span class="p">}</span><span class="w">

</span><span class="nv">$CmbBuild_SelectedIndexChanged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">$BtnUpdate</span><span class="o">.</span><span class="nf">Enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$True</span><span class="w"> </span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<h3 id="6-필요한-경우-자동-업데이트를-비활성화">6) (필요한 경우) 자동 업데이트를 비활성화</h3>
<p>만약 특정 빌드에 문제가 있어 이전 버전으로 다운그레이드 하는 경우, 다시 자동으로 업데이트가 된다면 힘들게 되돌린 의미가 없어집니다.</p>

<p>필요한 경우 자동 업데이트를 중지합니다.<br />
  <img src="http://localhost:4000/assets/images/posts/2022-07-10-Offfice365-Update-script-checkbox.png" alt="drop-down-list" /></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">if</span><span class="p">(</span><span class="nv">$ChkUpdate</span><span class="o">.</span><span class="nf">Checked</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="bp">$true</span><span class="p">){</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Disable updates......."</span><span class="w">
    </span><span class="n">Start-Process</span><span class="w"> </span><span class="nx">powershell.exe</span><span class="w"> </span><span class="nt">-Verb</span><span class="w"> </span><span class="nx">runAs</span><span class="p">{</span><span class="w">
    </span><span class="n">Set-ItemProperty</span><span class="w"> </span><span class="nt">-Path</span><span class="w"> </span><span class="nx">Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\ClickToRun\Configuration</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nx">UpdatesEnabled</span><span class="w"> </span><span class="nt">-Value</span><span class="w"> </span><span class="s2">"False"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="결과">결과</h2>
<p>코드 전문은 아래에서 확인할 수 있습니다.<br />
<a href="https://github.com/scho89/Update-Office365">Update-Office365</a></p>

<p>또는 PowerShell에서 아래의 명령어로 스크립트 설치도 가능합니다.</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Install-Script</span><span class="w"> </span><span class="nx">Update-Office365</span><span class="w">
</span></code></pre></div></div>

<p>설치된 스크립트는 보통 아래 경로에 저장됩니다.<br />
<code class="language-plaintext highlighter-rouge">C:\Users\&lt;UserName&gt;\Documents\WindowsPowerShell\Scripts</code></p>]]></content><author><name>조상호 / Sangho Cho</name></author><category term="en-us" /><category term="Microsoft365" /><category term="PowerShell" /><summary type="html"><![CDATA[Background It starts from idea of colleague.]]></summary></entry><entry><title type="html">Foo Bar Identity</title><link href="http://localhost:4000/math/math/" rel="alternate" type="text/html" title="Foo Bar Identity" /><published>2022-07-10T00:00:00+00:00</published><updated>2022-07-10T00:00:00+00:00</updated><id>http://localhost:4000/math/math</id><content type="html" xml:base="http://localhost:4000/math/math/"><![CDATA[\[x+y=3\]]]></content><author><name>조상호 / Sangho Cho</name></author><category term="Math" /><summary type="html"><![CDATA[Foo Bar design system including logo mark, website design, and branding applications.]]></summary></entry><entry><title type="html">Foo Bar Identity</title><link href="http://localhost:4000/foo-bar-website/" rel="alternate" type="text/html" title="Foo Bar Identity" /><published>2022-07-03T00:00:00+00:00</published><updated>2022-07-03T00:00:00+00:00</updated><id>http://localhost:4000/foo-bar-website</id><content type="html" xml:base="http://localhost:4000/foo-bar-website/"><![CDATA[<p>Pictures of Goats section West Seattle Blog dingbat newspaper rubber cement Google+ newsroom cafe news.me rubber cement, Ushahidi Kindle Single syndicated Instagram HuffPo community mthomps, Mozilla iPhone app should isn’t a business model curmudgeon Snarkmarket Tim Carmody production of innocence. Fuego tweets community DocumentCloud metered model Gardening &amp; War section YouTube social media SEO information overload analytics Aron Pilhofer Journal Register data visualization WikiLeaks Groupon, collaboration Steve Jobs we need a Nate Silver AP What Would Google Do the power of the press belongs to the person who owns one Clay Shirky curmudgeon Voice of San Diego free as in beer dead trees the notion of the public Lucius Nieman.</p>

<figure class="third ">
  
    
      <a href="/unsplash-gallery-image-1.jpg">
          <img src="/unsplash-gallery-image-1-th.jpg" alt="placeholder image 1" />
      </a>
    
  
    
      <a href="/unsplash-gallery-image-2.jpg">
          <img src="/unsplash-gallery-image-2-th.jpg" alt="placeholder image 2" />
      </a>
    
  
    
      <a href="/unsplash-gallery-image-3.jpg">
          <img src="/unsplash-gallery-image-3-th.jpg" alt="placeholder image 3" />
      </a>
    
  
  
    <figcaption>This is a sample gallery to go along with this case study.
</figcaption>
  
</figure>

<p>hackgate copyright Lucius Nieman CNN leaves it there right-sizing a giant stack of newspapers that you’ll never read net neutrality algorithms RT algorithms TechCrunch 5% corruption, horse-race coverage Gardening &amp; War section CTR try PR CPC David Cohn shoot a photo algorithms content is king Android Snarkmarket crowdfunding, Fuego Twitter topples dictators YouTube abundance WordPress Reuters try PR stupid commenters should isn’t a business model bringing a tote bag to a knife fight.</p>

<figure class="third ">
  
    
      <a href="/unsplash-gallery-image-1.jpg">
          <img src="/unsplash-gallery-image-1-th.jpg" alt="placeholder image 1" />
      </a>
    
  
    
      <a href="/unsplash-gallery-image-2.jpg">
          <img src="/unsplash-gallery-image-2-th.jpg" alt="placeholder image 2" />
      </a>
    
  
    
      <a href="/unsplash-gallery-image-3.jpg">
          <img src="/unsplash-gallery-image-3-th.jpg" alt="placeholder image 3" />
      </a>
    
  
  
    <figcaption>This is a sample gallery2 to go along with this case study.
</figcaption>
  
</figure>]]></content><author><name>조상호 / Sangho Cho</name></author><summary type="html"><![CDATA[Foo Bar design system including logo mark, website design, and branding applications.]]></summary></entry><entry><title type="html">Office 365 post 1</title><link href="http://localhost:4000/%EC%9D%B4%EB%9F%B0%EA%B1%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%82%98%EC%98%A4%EB%82%98/" rel="alternate" type="text/html" title="Office 365 post 1" /><published>2022-07-03T00:00:00+00:00</published><updated>2022-07-03T00:00:00+00:00</updated><id>http://localhost:4000/%EC%9D%B4%EB%9F%B0%EA%B1%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%82%98%EC%98%A4%EB%82%98</id><content type="html" xml:base="http://localhost:4000/%EC%9D%B4%EB%9F%B0%EA%B1%B4-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%82%98%EC%98%A4%EB%82%98/"><![CDATA[<p>Nested and mixed lists are an interesting beast. It’s a corner case to make sure that</p>

<ul>
  <li>Lists within lists do not break the ordered list numbering order</li>
  <li>Your list styles go deep enough.</li>
</ul>

<h3 id="ordered--unordered--ordered">Ordered – Unordered – Ordered</h3>

<ol>
  <li>ordered item</li>
  <li>ordered item
    <ul>
      <li><strong>unordered</strong></li>
      <li><strong>unordered</strong>
        <ul>
          <li><strong>unordered2</strong></li>
          <li><strong>unordered2</strong>
            <ol>
              <li>ordered item</li>
              <li>ordered item</li>
            </ol>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ordered item</li>
  <li>ordered item</li>
</ol>

<h4 id="ordered--unordered--unordered">Ordered – Unordered – Unordered</h4>

<ol>
  <li>ordered item</li>
  <li>ordered item
    <ul>
      <li><strong>unordered</strong></li>
      <li><strong>unordered</strong>
        <ul>
          <li>unordered item</li>
          <li>unordered item</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ordered item</li>
  <li>ordered item</li>
</ol>

<h4 id="unordered--ordered--unordered">Unordered – Ordered – Unordered</h4>

<ul>
  <li>unordered item</li>
  <li>unordered item
    <ol>
      <li>ordered</li>
      <li>ordered
        <ul>
          <li>unordered item</li>
          <li>unordered item</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>unordered item</li>
  <li>unordered item</li>
</ul>

<h3 id="unordered--unordered--ordered">Unordered – Unordered – Ordered</h3>

<ul>
  <li>unordered item</li>
  <li>unordered item
    <ul>
      <li>unordered</li>
      <li>unordered
        <ol>
          <li><strong>ordered item</strong></li>
          <li><strong>ordered item</strong></li>
        </ol>
      </li>
    </ul>
  </li>
  <li>unordered item</li>
  <li>unordered item</li>
</ul>

<h3 id="task-lists">Task Lists</h3>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Finish my changes</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Push my commits to GitHub</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Open a pull request</li>
</ul>]]></content><author><name>조상호 / Sangho Cho</name></author><summary type="html"><![CDATA[Nested and mixed lists are an interesting beast. It’s a corner case to make sure that]]></summary></entry><entry><title type="html">Office 365 post 1</title><link href="http://localhost:4000/office-365-test-post/" rel="alternate" type="text/html" title="Office 365 post 1" /><published>2022-07-03T00:00:00+00:00</published><updated>2022-07-03T00:00:00+00:00</updated><id>http://localhost:4000/office-365-test-post</id><content type="html" xml:base="http://localhost:4000/office-365-test-post/"><![CDATA[<p>Nested and mixed lists are an interesting beast. It’s a corner case to make sure that</p>

<ul>
  <li>Lists within lists do not break the ordered list numbering order</li>
  <li>Your list styles go deep enough.</li>
</ul>

<h3 id="ordered--unordered--ordered">Ordered – Unordered – Ordered</h3>

<ol>
  <li>ordered item</li>
  <li>ordered item
    <ul>
      <li><strong>unordered</strong></li>
      <li><strong>unordered</strong>
        <ul>
          <li><strong>unordered2</strong></li>
          <li><strong>unordered2</strong>
            <ol>
              <li>ordered item</li>
              <li>ordered item</li>
            </ol>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ordered item</li>
  <li>ordered item</li>
</ol>

<h4 id="ordered--unordered--unordered">Ordered – Unordered – Unordered</h4>

<ol>
  <li>ordered item</li>
  <li>ordered item
    <ul>
      <li><strong>unordered</strong></li>
      <li><strong>unordered</strong>
        <ul>
          <li>unordered item</li>
          <li>unordered item</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ordered item</li>
  <li>ordered item</li>
</ol>

<h4 id="unordered--ordered--unordered">Unordered – Ordered – Unordered</h4>

<ul>
  <li>unordered item</li>
  <li>unordered item
    <ol>
      <li>ordered</li>
      <li>ordered
        <ul>
          <li>unordered item</li>
          <li>unordered item</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>unordered item</li>
  <li>unordered item</li>
</ul>

<h3 id="unordered--unordered--ordered">Unordered – Unordered – Ordered</h3>

<ul>
  <li>unordered item</li>
  <li>unordered item
    <ul>
      <li>unordered</li>
      <li>unordered
        <ol>
          <li><strong>ordered item</strong></li>
          <li><strong>ordered item</strong></li>
        </ol>
      </li>
    </ul>
  </li>
  <li>unordered item</li>
  <li>unordered item</li>
</ul>

<h3 id="task-lists">Task Lists</h3>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Finish my changes</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Push my commits to GitHub</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Open a pull request</li>
</ul>]]></content><author><name>조상호 / Sangho Cho</name></author><summary type="html"><![CDATA[Nested and mixed lists are an interesting beast. It’s a corner case to make sure that]]></summary></entry><entry><title type="html">Office 365 post 1</title><link href="http://localhost:4000/office365/edge-case-nested-and-mixed-lists/" rel="alternate" type="text/html" title="Office 365 post 1" /><published>2022-07-03T00:00:00+00:00</published><updated>2022-07-03T00:00:00+00:00</updated><id>http://localhost:4000/office365/edge-case-nested-and-mixed-lists</id><content type="html" xml:base="http://localhost:4000/office365/edge-case-nested-and-mixed-lists/"><![CDATA[<p>Nested and mixed lists are an interesting beast. It’s a corner case to make sure that</p>

<ul>
  <li>Lists within lists do not break the ordered list numbering order</li>
  <li>Your list styles go deep enough.</li>
</ul>

<h3 id="ordered--unordered--ordered">Ordered – Unordered – Ordered</h3>

<ol>
  <li>ordered item</li>
  <li>ordered item
    <ul>
      <li><strong>unordered</strong></li>
      <li><strong>unordered</strong>
        <ul>
          <li><strong>unordered2</strong></li>
          <li><strong>unordered2</strong>
            <ol>
              <li>ordered item</li>
              <li>ordered item</li>
            </ol>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ordered item</li>
  <li>ordered item</li>
</ol>

<h4 id="ordered--unordered--unordered">Ordered – Unordered – Unordered</h4>

<ol>
  <li>ordered item</li>
  <li>ordered item
    <ul>
      <li><strong>unordered</strong></li>
      <li><strong>unordered</strong>
        <ul>
          <li>unordered item</li>
          <li>unordered item</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ordered item</li>
  <li>ordered item</li>
</ol>

<h4 id="unordered--ordered--unordered">Unordered – Ordered – Unordered</h4>

<ul>
  <li>unordered item</li>
  <li>unordered item
    <ol>
      <li>ordered</li>
      <li>ordered
        <ul>
          <li>unordered item</li>
          <li>unordered item</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>unordered item</li>
  <li>unordered item</li>
</ul>

<h3 id="unordered--unordered--ordered">Unordered – Unordered – Ordered</h3>

<ul>
  <li>unordered item</li>
  <li>unordered item
    <ul>
      <li>unordered</li>
      <li>unordered
        <ol>
          <li><strong>ordered item</strong></li>
          <li><strong>ordered item</strong></li>
        </ol>
      </li>
    </ul>
  </li>
  <li>unordered item</li>
  <li>unordered item</li>
</ul>

<h3 id="task-lists">Task Lists</h3>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />Finish my changes</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Push my commits to GitHub</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Open a pull request</li>
</ul>]]></content><author><name>조상호 / Sangho Cho</name></author><category term="Office365" /><category term="Exchange Online" /><category term="Email" /><category term="Mail flow" /><summary type="html"><![CDATA[Nested and mixed lists are an interesting beast. It’s a corner case to make sure that]]></summary></entry><entry><title type="html">Exclude Post from Search Index</title><link href="http://localhost:4000/jekyll/post-exclude-search/" rel="alternate" type="text/html" title="Exclude Post from Search Index" /><published>2017-11-28T00:00:00+00:00</published><updated>2018-02-19T13:06:00+00:00</updated><id>http://localhost:4000/jekyll/post-exclude-search</id><content type="html" xml:base="http://localhost:4000/jekyll/post-exclude-search/"><![CDATA[<p>This post should not appear in the search index because it has the following YAML Front Matter:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">search</span><span class="pi">:</span> <span class="no">false</span>
</code></pre></div></div>

<p class="notice--info"><strong>Note:</strong> <code class="language-plaintext highlighter-rouge">search: false</code> only works to exclude posts when using Lunr as a search provider.</p>

<p>To exclude files when using Algolia as a search provider add an array to <code class="language-plaintext highlighter-rouge">algolia.files_to_exclude</code> in your <code class="language-plaintext highlighter-rouge">_config.yml</code>. For more configuration options be sure to check their <a href="https://community.algolia.com/jekyll-algolia/options.html">full documentation</a>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">algolia</span><span class="pi">:</span>
  <span class="c1"># Exclude more files from indexing</span>
  <span class="na">files_to_exclude</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">index.html</span>
    <span class="pi">-</span> <span class="s">index.md</span>
    <span class="pi">-</span> <span class="s">excluded-file.html</span>
    <span class="pi">-</span> <span class="s">_posts/2017-11-28-post-exclude-search.md</span>
    <span class="pi">-</span> <span class="s">subdirectory/*.html</span>
</code></pre></div></div>]]></content><author><name>조상호 / Sangho Cho</name></author><category term="Jekyll" /><summary type="html"><![CDATA[This post should not appear in the search index because it has the following YAML Front Matter:]]></summary></entry><entry><title type="html">Layout: Header Video</title><link href="http://localhost:4000/layout/uncategorized/layout-header-video/" rel="alternate" type="text/html" title="Layout: Header Video" /><published>2017-01-23T00:00:00+00:00</published><updated>2017-01-23T00:00:00+00:00</updated><id>http://localhost:4000/layout/uncategorized/layout-header-video</id><content type="html" xml:base="http://localhost:4000/layout/uncategorized/layout-header-video/"><![CDATA[<p>This post should display a <strong>header with a responsive video</strong>, if the theme supports it.</p>

<h2 id="settings">Settings</h2>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Required</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">id</code></td>
      <td><strong>Required</strong></td>
      <td>ID of the video</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">provider</code></td>
      <td><strong>Required</strong></td>
      <td>Hosting provider of the video, either <code class="language-plaintext highlighter-rouge">youtube</code> or <code class="language-plaintext highlighter-rouge">vimeo</code></td>
    </tr>
  </tbody>
</table>

<h3 id="youtube">YouTube</h3>

<p>To embed the following YouTube video at url <code class="language-plaintext highlighter-rouge">https://www.youtube.com/watch?v=-PVofD2A9t8</code> (long version) or <code class="language-plaintext highlighter-rouge">https://youtu.be/-PVofD2A9t8</code> (short version) into a post or page’s main content you’d use:</p>

<div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="w"> </span><span class="nv">video</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s2">"-PVofD2A9t8"</span><span class="w"> </span><span class="na">provider</span><span class="o">=</span><span class="s2">"youtube"</span><span class="w"> </span><span class="p">%}</span>
</code></pre></div></div>

<!-- Courtesy of embedresponsively.com -->

<div class="responsive-video-container">
    <iframe src="https://www.youtube-nocookie.com/embed/-PVofD2A9t8" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<p>To embed it as a video header you’d use the following YAML Front Matter</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">header</span><span class="pi">:</span>
  <span class="na">video</span><span class="pi">:</span>
    <span class="na">id</span><span class="pi">:</span> <span class="s">-PVofD2A9t8</span>
    <span class="na">provider</span><span class="pi">:</span> <span class="s">youtube</span>
</code></pre></div></div>

<h3 id="vimeo">Vimeo</h3>

<p>To embed the following Vimeo video at url <code class="language-plaintext highlighter-rouge">https://vimeo.com/212731897</code> into a post or page’s main content you’d use:</p>

<div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{%</span><span class="w"> </span><span class="nt">include</span><span class="w"> </span><span class="nv">video</span><span class="w"> </span><span class="na">id</span><span class="o">=</span><span class="s2">"212731897"</span><span class="w"> </span><span class="na">provider</span><span class="o">=</span><span class="s2">"vimeo"</span><span class="w"> </span><span class="p">%}</span>
</code></pre></div></div>

<!-- Courtesy of embedresponsively.com -->

<div class="responsive-video-container">
    <iframe src="https://player.vimeo.com/video/212731897?dnt=true" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
  </div>

<p>To embed it as a video header you’d use the following YAML Front Matter</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">header</span><span class="pi">:</span>
  <span class="na">video</span><span class="pi">:</span>
    <span class="na">id</span><span class="pi">:</span> <span class="m">212731897</span>
    <span class="na">provider</span><span class="pi">:</span> <span class="s">vimeo</span>
</code></pre></div></div>]]></content><author><name>조상호 / Sangho Cho</name></author><category term="Layout" /><category term="Uncategorized" /><category term="video" /><category term="layout" /><summary type="html"><![CDATA[This post should display a header with a responsive video, if the theme supports it.]]></summary></entry><entry><title type="html">Gemified Theme – Beta Release</title><link href="http://localhost:4000/jekyll/gemified-theme-beta/" rel="alternate" type="text/html" title="Gemified Theme – Beta Release" /><published>2016-10-06T00:00:00+00:00</published><updated>2018-03-20T20:01:04+00:00</updated><id>http://localhost:4000/jekyll/gemified-theme-beta</id><content type="html" xml:base="http://localhost:4000/jekyll/gemified-theme-beta/"><![CDATA[<p>Hot on the heels of Jekyll v3.3.0 is a beta release of Minimal Mistakes… as a gemified theme.</p>

<p><a href="https://rubygems.org/gems/minimal-mistakes-jekyll"><code class="language-plaintext highlighter-rouge">minimal-mistakes-jekyll</code></a> can only be used with Jekyll proper. If you’re hosting on GitHub Pages or using that gem the theme won’t work. 3rd party themes haven’t been white-listed so it’s a no go for now.</p>

<p>Fine with all that? Great. Let’s continue.</p>

<p>If you’re migrating a site already using Minimal Mistakes and haven’t customized any of the <code class="language-plaintext highlighter-rouge">_includes</code>, <code class="language-plaintext highlighter-rouge">_layouts</code>, <code class="language-plaintext highlighter-rouge">_sass</code> partials, or <code class="language-plaintext highlighter-rouge">assets</code> this should be quick and painless.</p>

<h2 id="step-1-remove-theme-files">Step 1: Remove Theme Files</h2>

<p>Remove <code class="language-plaintext highlighter-rouge">_includes</code>, <code class="language-plaintext highlighter-rouge">_layouts</code>, <code class="language-plaintext highlighter-rouge">_sass</code>, <code class="language-plaintext highlighter-rouge">assets</code> folders and files within. You won’t need these anymore as they’re bundled in the theme.</p>

<p>If you customized any of these then leave them alone and only remove the untouched ones. If setup correctly your modified versions should act as <a href="http://jekyllrb.com/docs/themes/#overriding-theme-defaults">overrides</a> to the versions bundled with the theme.</p>

<h2 id="step-2-update-gemfile">Step 2: Update <code class="language-plaintext highlighter-rouge">Gemfile</code></h2>

<p>Replace <code class="language-plaintext highlighter-rouge">gem "github-pages</code> or <code class="language-plaintext highlighter-rouge">gem "jekyll"</code> with <code class="language-plaintext highlighter-rouge">gem "jekyll", "~&gt; 3.3.0"</code>. You’ll need the latest version of Jekyll<sup id="fnref:update-jekyll" role="doc-noteref"><a href="#fn:update-jekyll" class="footnote" rel="footnote">1</a></sup> for Minimal Mistakes to work and load all of the /assets/ properly.</p>

<p>Add the Minimal Mistakes theme gem:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">gem</span> <span class="s2">"minimal-mistakes-jekyll"</span>
</code></pre></div></div>

<p>When finished your <code class="language-plaintext highlighter-rouge">Gemfile</code> should look something like this:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">source</span> <span class="s2">"https://rubygems.org"</span>

<span class="n">gem</span> <span class="s2">"jekyll"</span><span class="p">,</span> <span class="s2">"~&gt; 3.3.0"</span>
<span class="n">gem</span> <span class="s2">"minimal-mistakes-jekyll"</span>
</code></pre></div></div>

<h2 id="step-3-run-bundler">Step 3: Run Bundler</h2>

<p>Run <code class="language-plaintext highlighter-rouge">bundle install</code> (or <code class="language-plaintext highlighter-rouge">bundle update</code> if you’re updating an existing repo) to install/update Jekyll and the theme.</p>

<h2 id="step-4-install-the-theme">Step 4: Install the Theme</h2>

<p>Add <code class="language-plaintext highlighter-rouge">theme: "minimal-mistakes-jekyll"</code> to your <code class="language-plaintext highlighter-rouge">_config.yml</code> file.</p>

<p>If you’re migrating from an existing Minimal Mistakes site you shouldn’t have to change anything else after this. If it’s a new site consult then docs to <a href="/docs/configuration/">properly config</a>.</p>

<p class="notice--danger"><strong>Please Note:</strong> Paths for image headers, overlays, teasers, <a href="/docs/helpers/#gallery">galleries</a>, and <a href="/docs/helpers/#feature-row">feature rows</a> have changed and now require a full path. Instead of just <code class="language-plaintext highlighter-rouge">image: filename.jpg</code> you’ll need to use the full path eg: <code class="language-plaintext highlighter-rouge">image: assets/images/filename.jpg</code>. The preferred location is now <code class="language-plaintext highlighter-rouge">assets/images</code> but can be placed elsewhere or external hosted. This all applies for image references in <code class="language-plaintext highlighter-rouge">_config.yml</code> and <code class="language-plaintext highlighter-rouge">author.yml</code> as well.</p>

<h2 id="step-5-jekyll-new-tweaks">Step 5: <code class="language-plaintext highlighter-rouge">jekyll new</code> Tweaks</h2>

<p>If this is a new site be sure to add the following files to <code class="language-plaintext highlighter-rouge">_data/</code> and customize as you see fit. There is currently no way of bundling them in with the theme, so be sure to consult the docs on how to properly use both.</p>

<ul>
  <li><a href="https://github.com/mmistakes/minimal-mistakes/blob/master/_data/ui-text.yml"><code class="language-plaintext highlighter-rouge">_data/ui-text.yml</code></a> - UI text <a href="/docs/ui-text/">documentation</a></li>
  <li><a href="https://github.com/mmistakes/minimal-mistakes/blob/master/_data/navigation.yml"><code class="language-plaintext highlighter-rouge">_data/navigation.yml</code></a> - navigation <a href="/docs/navigation/">documentation</a></li>
</ul>

<p>You’ll also need to:</p>

<ul>
  <li>Replace <code class="language-plaintext highlighter-rouge">&lt;site root&gt;/index.html</code> with a modified <a href="https://github.com/mmistakes/minimal-mistakes/blob/master/index.html">Minimal Mistakes <code class="language-plaintext highlighter-rouge">index.html</code></a>.</li>
  <li>Change <code class="language-plaintext highlighter-rouge">layout: post</code> in <code class="language-plaintext highlighter-rouge">_posts/0000-00-00-welcome-to-jekyll.markdown</code> to <code class="language-plaintext highlighter-rouge">layout: single</code>.</li>
  <li>Remove <code class="language-plaintext highlighter-rouge">about.md</code>, or at the very least change <code class="language-plaintext highlighter-rouge">layout: page</code> to <code class="language-plaintext highlighter-rouge">layout: single</code> and remove references to <code class="language-plaintext highlighter-rouge">icon-github.html</code> (or <a href="https://github.com/jekyll/minima/tree/master/_includes">copy to your <code class="language-plaintext highlighter-rouge">_includes</code></a> if using).</li>
</ul>

<hr />

<p>That’s it! If all goes well running <code class="language-plaintext highlighter-rouge">bundle exec jekyll serve</code> should spin-up your site. If you encounter any bumps please file an issue on GitHub and make sure to indicate you’re testing the pre-release Ruby gem version.</p>

<p><a href="https://github.com/mmistakes/minimal-mistakes/issues/new" class="btn btn--info btn--large">File an issue</a></p>

<p>Thanks!</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:update-jekyll" role="doc-endnote">
      <p>You could also run <code class="language-plaintext highlighter-rouge">bundle update jekyll</code> to update Jekyll. <a href="#fnref:update-jekyll" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name>조상호 / Sangho Cho</name></author><category term="Jekyll" /><category term="update" /><summary type="html"><![CDATA[Hot on the heels of Jekyll v3.3.0 is a beta release of Minimal Mistakes… as a gemified theme.]]></summary></entry></feed>